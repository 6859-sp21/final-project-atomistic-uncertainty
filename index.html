
<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v6.js"></script>
<script src="https://unpkg.com/d3-simple-slider"></script>
<script src="https://d3js.org/d3-color.v1.min.js"></script>
<script src="https://d3js.org/d3-hsv.v0.1.min.js"></script>

<head> 
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500&display=swap" rel="stylesheet">
</head>

<body>
    <div>
        <div id="sections" style="width: 95%;">
            <section class="step">
                <div style="text-align: center;">
                    <h1>
                        Visualizing Uncertainty in Molecular Simulation
                    </h1>
                    <p>
                        By Aik Jun Tan, Daniel Schwalbe-Koda, and Franklin Morgan
                    </p>  
                    <img style="padding-top: 30px; padding-bottom: 20px; width: 40%;" src="figs/intro/geometries.png"/>
                    <p style="color: grey;">&#8595; SCROLL TO BEGIN &#8595;</p>      
                    
                </div>
            </section>
            <section class="step s_small">
                <div style="width:40%;">
                    <h2>Understanding material behavior</h2>
                    <p>
                        A potential energy surface (PES) describes the energy of a system based the configuration of atoms within it. PESes are crucial in the study of materials science for understanding how materials will behave under varying conditions. 
                    </p>
                    <p>
                        Creating accurate models of these PESes means we can discover and use better materials in many different applications--from characterizing drug activity and toxicity, to creating stronger steel compositions for spacecraft, to developing catalysts for producing oxygen on Mars!
                    </p>
                    <p>
                        Traditionally, "brute force" methods such as ab initio molecular dynamic simulations are used to generate potential energy surfaces. However, these methods require extremely high computing power, and are cost-prohibitive for larger and more complex materials systems. 
                    </p>
                    <p>
                        Fortunately, recent advances in machine learning techniques allow for high-accuracy predictions in less time and at lower costs.
                    </p>
                </div>
            </section>
            <section class="step s_small">
                <div style="width: 40%; font-size: 26px;">
                    <p><em>Let's take a look at how this works...</em></p>
                </div>
            </section>
            <section class="step" style="color: white;">""</section>


            <section class="step s_small flex-container">
                <div style="width: 40%">
                    <h2>Neural networks</h2>
                    <p>
                        One machine learning technique, the neural network, is especially well suited to handle the extensive datasets needed to train PESes for complex materials. 
                    </p>
                    <p>
                        This algorithm receives data from previous ab initio molecular simulations, which measure the energy of a system based on a specific configuration of atoms. 
                    </p>
                    <p>
                        The neural network then uses these data to make predictions on that system's potential energy surface. This allows us to quickly predict material behavior for configurations that have not been explicitly tested.
                    </p>
                </div>
            </section>
            <section class="step s_small flex-container">
                <div style="width: 40%; font-size: 26px;">
                    <p><em>But are these predictions accurate?</em></p>
                </div>
            </section>
            <section class="step" style="color: white;">""</section>
            <section class="step s_small flex-container" style="width:100%;">
                <div style="width:40%;">
                    <h2>Prediction uncertainty in neural networks</h2>
                    <p>
                        There is always some uncertainty in the predictions made by neural networks. Consider the neural network to the right, which predicts whether an input image represents a dog or a cat. 
                    </p>
                    <p>
                        Hover over three different input photos to see how the network makes a prediction under uncertainty:
                    </p>
                   <div style="width: 90%; text-align: center;" class="flex-container">
                        <img id="cat" style="width: 28%;" src="figs/intro/cat.png"/>
                        <img id="dog" style="width: 28%;" src="figs/intro/dog.png"/>
                        <img id="bird" style="width: 28%;" src="figs/intro/bird.png"/>
                   </div>
                </div>
                <div style="width:60%; text-align: center; margin-top: 80px;">
                    <img id="animals" src="figs/intro/nn_hover.png" style="width:90%;"/>
                </div>
            </section>

            <section class="step flex-container" style="width:100%;">
                <div style="width: 40%;">
                    <p>
                        Neural networks predicting potential energy surfaces face similar challenges to those outlined in the example above. While the algorithm predicts data between existing data points very well (similar to the cat and dog), it may fail catastrophically for rare events for which we have little to no data (similar to the bird).
                    </p>
                    <p>
                        Hover over the three different input geometries to see how the network makes a prediction under uncertainty:
                    </p>
                   <div style="width: 90%; text-align: center;" class="flex-container">
                        <img id="mol1" style="width: 28%;" src="figs/intro/mol1.png"/>
                        <img id="mol2" style="width: 28%;" src="figs/intro/mol2.png"/>
                        <img id="mol3" style="width: 28%;" src="figs/intro/mol3.png"/>
                   </div>
                </div>
                <div style="width:60%; text-align: center; margin-top: 80px;">
                    <img id="molnn" src="figs/intro/molnn_1.png" style="width:90%;"/>
                </div>
            </section>

            <section class="step s_small">
                <div style="width: 40%; font-size: 26px;">
                    <p><em>One problem, therefore, is: how to assess the reliability of neural network predictions?</em></p>
                </div>
            </section>
            <section class="step" style="color: white;">""</section>

            <section class="step" style="width:40%;">
                <h2>
                    Uncertainty Quantification
                </h2>
                    <p>
                        Instead of using a single neural network to make predictions, we can use an ensemble of neural networks. When the data is well-represented in the training set, the neural network committee predicts a single value with low uncertainty. On the other hand, when the data is not well-known, the NNs will disagree on the predicted property, thus leading to a higher uncertainty.
                    </p>
                    <p>
                        In the case of molecular simulation, it is more interesting to use uncertainty in the predicted forces instead of predicted energy. 
                    </p>
            </section>
            <section class="step s_small">
                <div style="width: 40%; font-size: 26px;">
                    <p><em>Now, the follow-up question: how do we improve the robustness of neural networks for atomistic simulations?</em></p>
                </div>
            </section>
            <section class="step" style="color: white;">""</section>

            <section class="step" style="width:40%;">
                <h2>
                    Adversarial Attacks
                </h2>
                    <p>
                        Improving the robustness of neural network potentials requires increasing the breadth of their training sets; however, gathering this data usually requires time-consuming and costly simulations. It is therefore crucial to only gather data that will significantly improve the model's ability to make accurate predictions.
                    </p>
                <p>
                    We propose using adversarial attacks to find the points which the neural network does not predict well. In atomistic simulations, that corresponds to adding a small disturbance &delta; to the input geometry and finding which are the distortions that maximize the uncertainty of the neural network committee. This optimization can be done by simply calculating the gradients of the uncertainty with respect to &delta;.
                </p>
                <p> Next, we exemplify how this method works... </p>
            </section>

            <section class="step" style="width:40%;">
                <h2>
                    Exemplifying adversarial attacks
                </h2>
                    <p>
                        Consider a 2D potential energy surface such as the one shown on the right. A toy example could be the 2D double well, which is a potential having two basins. We can train a neural network committee to predict this potential energy surface and then analyze the energies and forces from this committee
                    </p>
            </section>

            <section class="step s_small" style="color: white;">""</section>
            <section id ="gen4" class="step">
                Generation 4
            </section>
            <section id ="gen5" class="step">
                Generation 5
            </section>
            <section id ="gen6" class="step">
                Generation 6
            </section>
            <section id ="gen7" class="step">
                Generation 7
            </section>
            <section id ="section4" class="step">
                The End
            </section>
            <section id ="section5" class="step">
                Filler
            </section>
            <section id ="section6" class="step">
                Filler
            </section>
        </div>


            <svg id="svgBlank" class = "visuals"></svg>
            <svg id='svgIntro1' viewBox = "-175 0 350 350" class = "visuals"></svg>
            <svg id='svgIntro2' viewBox = "-225 -50 550 550" class = "visuals"></svg>
            <svg id='svgIntro3' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgIntro3Cat' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgIntro3Dog' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgIntro3Bird' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgIntro4' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgIntro4_1' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgIntro4_2' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgIntro4_3' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgUncertainty1' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgUncertainty2' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgUncertainty3' viewBox = "-1600 -500 3500 3500" class = "visuals"></svg>
            <svg id='svgAttacks1' viewBox = "-200 -50 450 350" class = "visuals"></svg>
            <svg id='svgAttacks2' viewBox = "-800 -200 2000 2000" class = "visuals"></svg>
            <svg id='svgGen1' viewBox = "-800 5000 5000" class = "visuals"></svg>
            <svg id='svgEnd' class = "visuals"></svg>

    </div>
</body>

<script src="scripts/scenes/base.js"></script>
<script src="scripts/scenes/title.js"></script>
<script src="scripts/scenes/svg.js"></script>
<script src="scripts/scenes/contour.js"></script>
<script src="scripts/sections/config.js"></script>
<script src="scripts/sections/title.js"></script>
<script src="scripts/sections/intro.js"></script>
<script src="scripts/sections/explanation.js"></script>
<script src="scripts/sections/evolution.js"></script>
<script src="scripts/scenes.js"></script>
<script src="scripts/scroller.js"></script>
<script src="scripts/scenes/hover.js"></script>


